
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Examples &#8212; pyphoon 2018a documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2018a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyphoon 2018a documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>Here we present some examples using the tools from the library. You can find
these examples <a class="reference external" href="https://github.com/lucasrodes/pyphoon/tree/master/scripts">here</a>.</p>
<p><strong>Contents:</strong></p>
<div class="line-block">
<div class="line"><a class="reference internal" href="#integrating-the-data"><span class="std std-ref">1. Integrating the data</span></a></div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#generate-a-typhoonsequence-hdf-file"><span class="std std-ref">1.1 Generate a TyphoonSequence HDF File</span></a></div>
</div>
<div class="line"><a class="reference internal" href="#dataset-overview"><span class="std std-ref">2. Dataset overview</span></a></div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#mean-image"><span class="std std-ref">2.1 Mean image</span></a></div>
<div class="line"><a class="reference internal" href="#visualize-a-typhoonsequence"><span class="std std-ref">2.2 Visualize a TyphoonList</span></a></div>
</div>
<div class="line"><a class="reference internal" href="#corrupted-files"><span class="std std-ref">3. Corrupted files</span></a></div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#corrupted-images"><span class="std std-ref">3.1 Corrupted images</span></a></div>
</div>
</div>
<div class="section" id="integrating-the-data">
<span id="id1"></span><h2>1. Integrating the data<a class="headerlink" href="#integrating-the-data" title="Permalink to this headline">¶</a></h2>
<p>The Digital Typhoon data is build from two main sources:</p>
<ul class="simple">
<li><strong>Satellite imagery:</strong> Images of typhoons taken from several geostationary satellites since 1978.</li>
<li><strong>Best Track:</strong> Several parameters of typhoons.</li>
</ul>
<p>Both components originally come in two different formats. All images
belonging to the a certain typhoon sequence are stored as HDF files under
the same folder. The best track data comes as TSV files (one per sequence also).
Therefore, the number of folders of images and TSV files should be the equal
to the number of considered typhoon sequences.</p>
<div class="section" id="generate-a-typhoonsequence-hdf-file">
<span id="id2"></span><h3>1.1 Generate a TyphoonSequence HDF File<a class="headerlink" href="#generate-a-typhoonsequence-hdf-file" title="Permalink to this headline">¶</a></h3>
<p>This library provides a set of tools to integrate both sources into
single HDF files. For this example, we suppose have the satellite images at
<cite>../original_data/image/</cite> and the best track data at <cite>../original_data/jma/</cite>
and that we want to create the integrated dataset at <cite>../data/integration_0</cite>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;agg&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">isdir</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">pyphoon.io</span> <span class="kn">import</span> <span class="n">create_typhoonlist_from_source</span>
<span class="kn">from</span> <span class="nn">pyphoon.clean.clean</span> <span class="kn">import</span> <span class="n">fix_sequence</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="c1"># Directories</span>
<span class="n">directory_images</span> <span class="o">=</span> <span class="s2">&quot;../original_data/image/&quot;</span>
<span class="n">directory_best</span> <span class="o">=</span> <span class="s2">&quot;../original_data/jma/&quot;</span>
<span class="c1"># Path destination</span>
<span class="n">path_normal</span> <span class="o">=</span> <span class="s1">&#39;../data/sequences/compressed_1/&#39;</span>
<span class="n">path_corrected</span> <span class="o">=</span> <span class="s1">&#39;../data/sequences/corrected_1/&#39;</span>
<span class="n">path_gapfilled</span> <span class="o">=</span> <span class="s1">&#39;../data/sequences/gapfilled_1/&#39;</span>

<span class="c1"># Get typhoon image sequence folders.</span>
<span class="n">folders</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">directory_images</span><span class="p">)</span> <span class="k">if</span> <span class="n">isdir</span><span class="p">(</span><span class="n">join</span><span class="p">(</span>
    <span class="n">directory_images</span><span class="p">,</span> <span class="n">f</span><span class="p">))])</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">folders</span><span class="p">))</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd"># Iterate over all folders</span>
<span class="sd">for folder in folders:</span>
<span class="sd">    file = folder+&quot;.h5&quot;</span>
<span class="sd">    path_images = join(directory_images, folder)</span>
<span class="sd">    path_best = join(directory_best, folder+&#39;.tsv&#39;)</span>
<span class="sd">    # path_newfile = join(directory_new_file, folder + &#39;.h5&#39;)</span>

<span class="sd">    # User info</span>
<span class="sd">    print(folder)</span>
<span class="sd">    print(file)</span>
<span class="sd">    print(&quot; source images:&quot;, path_images)</span>
<span class="sd">    print(&quot; source metadata:&quot;, path_best)</span>
<span class="sd">    # print(&quot; new H5 file:&quot;, path_newfile)</span>

<span class="sd">    # Create and store TyphoonSequence</span>
<span class="sd">    t0 = time.time()</span>
<span class="sd">    sequence = create_typhoonlist_from_source(</span>
<span class="sd">        path_images=path_images,</span>
<span class="sd">        path_best=path_best</span>
<span class="sd">    )</span>
<span class="sd">    print(&quot; loaded&quot;, time.time() - t0)</span>

<span class="sd">    # Save</span>
<span class="sd">    t0 = time.time()</span>
<span class="sd">    sequence.save_as_h5(join(path_normal, file), compression=&quot;gzip&quot;)</span>
<span class="sd">    print(&quot; compressed&quot;, time.time() - t0)</span>

<span class="sd">    # Correct</span>
<span class="sd">    t0 = time.time()</span>
<span class="sd">    sequence = fix_sequence(sequence, gap_filling=False, display=False)</span>
<span class="sd">    sequence.save_as_h5(join(path_corrected, file), compression=&quot;gzip&quot;)</span>
<span class="sd">    print(&quot; corrected&quot;, time.time() - t0)</span>

<span class="sd">    # Fill gaps</span>
<span class="sd">    t0 = time.time()</span>
<span class="sd">    sequence = fix_sequence(sequence, gap_filling=True, display=False)</span>
<span class="sd">    sequence.save_as_h5(join(path_gapfilled, file), compression=&quot;gzip&quot;)</span>
<span class="sd">    print(&quot; gapfilling&quot;, time.time() - t0)</span>

<span class="sd">    #sequence.save_as_h5(path_newfile, compression=&#39;gzip&#39;)</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</td></tr></table></div>
<p>We note that <code class="xref py py-func docutils literal"><span class="pre">save_as_h5()</span></code> has an
option to save the data in a compressed format.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://github.com/lucasrodes/pyphoon/tree/master/scripts/generate_hdf_files.py">script</a></p>
</div>
</div>
</div>
<div class="section" id="dataset-overview">
<span id="id3"></span><h2>2. Dataset overview<a class="headerlink" href="#dataset-overview" title="Permalink to this headline">¶</a></h2>
<p>Having a high-level overview of the dataset may provide interesting insights.</p>
<div class="section" id="mean-image">
<span id="id4"></span><h3>2.1 Mean image<a class="headerlink" href="#mean-image" title="Permalink to this headline">¶</a></h3>
<p>It is interesting to obtain the mean image of the image dataset. In large
datasets, like Digital Typhoon’s, loading all the data is not possible.
Hence, the mean image has to be sequentially obtained.</p>
<p>We can easily obtain the deviation image, the maximum value image and minimum
value image as they do not require much more additional power.</p>
<p>For this example, we use the already generated TyphoonSequence HDF files
stored in <cite>../data/integration_0</cite> and store the results in <cite>../data/</cite>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;agg&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">pyphoon.io</span> <span class="kn">import</span> <span class="n">read_typhoonlist_h5</span>
<span class="kn">from</span> <span class="nn">pyphoon.io.h5</span> <span class="kn">import</span> <span class="n">get_h5_filenames</span><span class="p">,</span> <span class="n">write_h5file</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>


<span class="c1"># Get filenames</span>
<span class="n">directory_images</span> <span class="o">=</span> <span class="s2">&quot;../data/others/integration_3&quot;</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">get_h5_filenames</span><span class="p">(</span><span class="n">directory_images</span><span class="p">)</span>

<span class="c1"># Parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">maxv</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">minv</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Iterate over all HDF files</span>
<span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
    <span class="c1"># Load sequence</span>
    <span class="n">typhoon_sequence</span> <span class="o">=</span> <span class="n">read_typhoonlist_h5</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory_images</span><span class="p">,</span> <span class="nb">file</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">typhoon_sequence</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>

    <span class="c1"># Sequentially update mean image</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mu2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">mu2</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">maxv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">maxv</span><span class="p">)</span>
    <span class="n">minv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">minv</span><span class="p">)</span>

<span class="c1"># Compute deviation image</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mu2</span> <span class="o">-</span> <span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Store images</span>
<span class="n">write_h5file</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">mu</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="n">std</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="n">maxv</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="n">minv</span><span class="p">},</span>
    <span class="n">path_to_file</span><span class="o">=</span><span class="s1">&#39;../data/preprocessing/params_0.h5&#39;</span><span class="p">,</span>
    <span class="n">compression</span><span class="o">=</span><span class="bp">None</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://github.com/lucasrodes/pyphoon/tree/master/scripts/mean_image.py">script</a></p>
</div>
</div>
<div class="section" id="visualize-a-typhoonlist">
<span id="visualize-a-typhoonsequence"></span><h3>2.2 Visualize a TyphoonList<a class="headerlink" href="#visualize-a-typhoonlist" title="Permalink to this headline">¶</a></h3>
<p>Visualizing a sequence can be sometimes helpful. In the following example we
visualize the sequence <strong>197906</strong> stored at <cite>../sampledata/197906.h5</cite>.
However, note that this can be extended to any other typhoon sequence.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyphoon.io</span> <span class="kn">import</span> <span class="n">read_typhoonlist_h5</span>
<span class="kn">from</span> <span class="nn">pyphoon.utils</span> <span class="kn">import</span> <span class="n">DisplaySequence</span>

<span class="c1"># Load sequence</span>
<span class="n">sequence</span> <span class="o">=</span> <span class="n">read_typhoonlist_h5</span><span class="p">(</span><span class="s1">&#39;../sampledata/197906.h5&#39;</span><span class="p">)</span>

<span class="c1"># Create DisplaySequence instance and run</span>
<span class="n">DisplaySequence</span><span class="p">(</span>
    <span class="n">typhoon_sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;201626&quot;</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://github.com/lucasrodes/pyphoon/tree/master/scripts/visualize_sequence.py">script</a>,
<a class="reference external" href="https://github.com/lucasrodes/pyphoon/tree/master/notebooks/Getting_Started.ipynb">notebook</a></p>
</div>
</div>
</div>
<div class="section" id="corrupted-files">
<span id="id7"></span><h2>3. Corrupted files<a class="headerlink" href="#corrupted-files" title="Permalink to this headline">¶</a></h2>
<p>Digital Typhoon is a project that aims to tackle a real-world issue. Hence,
it contains real-world data, which often contains some errors. Finding and
correcting those errors becomes essential so as to be able to rely on the
given data.</p>
<div class="section" id="corrupted-images">
<span id="id8"></span><h3>3.1 Corrupted images<a class="headerlink" href="#corrupted-images" title="Permalink to this headline">¶</a></h3>
<p>The following example finds the corrupted frames in all sequences under the
directory <code class="docutils literal"><span class="pre">data/integration_0</span></code> and stores them as images under
<code class="docutils literal"><span class="pre">data/corrupted_0</span></code>.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">pyphoon.io</span> <span class="kn">import</span> <span class="n">read_typhoonlist_h5</span>
<span class="kn">from</span> <span class="nn">pyphoon.io.h5</span> <span class="kn">import</span> <span class="n">get_h5_filenames</span>
<span class="kn">from</span> <span class="nn">pyphoon.clean.clean</span> <span class="kn">import</span> <span class="n">find_corrupted_frames</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c1"># TODO: Not compiling!</span>
<span class="c1"># Directories</span>
<span class="n">directory_files_0</span> <span class="o">=</span> <span class="s2">&quot;../data/others/integration_3/&quot;</span>
<span class="n">directory_corrupted_0</span> <span class="o">=</span> <span class="s2">&quot;../data/corrupted/iter_1&quot;</span>

<span class="c1"># Get H5 file names</span>
<span class="n">files_0</span> <span class="o">=</span> <span class="n">get_h5_filenames</span><span class="p">(</span><span class="n">directory_files_0</span><span class="p">)</span>

<span class="c1"># Iterate over all files from integration_0</span>
<span class="n">corrupted_frames</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">file_0</span> <span class="ow">in</span> <span class="n">files_0</span><span class="p">:</span>

    <span class="c1"># Load sequence</span>
    <span class="n">path_file_0</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">directory_files_0</span><span class="p">,</span> <span class="n">file_0</span><span class="p">)</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="n">read_typhoonlist_h5</span><span class="p">(</span>
        <span class="n">path_to_file</span><span class="o">=</span><span class="n">path_file_0</span>
    <span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file_0</span><span class="p">)</span>

    <span class="c1"># Get corrupted frame indices</span>
    <span class="n">_corrupted_frames</span><span class="p">,</span> <span class="n">_corrupted_info</span> <span class="o">=</span> <span class="n">find_corrupted_frames</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="n">corrupted_frames</span><span class="p">[</span><span class="n">sequence</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_corrupted_frames</span>

    <span class="c1">#  Save corrupted image frames as images</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">corrupted_frame</span><span class="p">,</span> <span class="n">frame_info</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_corrupted_frames</span><span class="p">,</span> <span class="n">_corrupted_info</span><span class="p">):</span>
        <span class="n">_info</span> <span class="o">=</span> <span class="s1">&#39; / &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">key</span> <span class="o">+</span> <span class="s2">&quot;: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">frame_info</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="n">frame_id</span> <span class="o">=</span> <span class="n">sequence</span><span class="o">.</span><span class="n">images_ids</span><span class="p">[</span><span class="n">corrupted_frame</span><span class="p">]</span>
        <span class="c1"># Clean plot</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sequence</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">corrupted_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">frame_id</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">_info</span><span class="p">)</span>
        <span class="c1">#  Save image</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">directory_corrupted_0</span><span class="p">,</span> <span class="n">frame_id</span><span class="p">))</span>
        <span class="c1"># User info</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;   [X] &quot;</span> <span class="o">+</span> <span class="n">frame_id</span> <span class="o">+</span> <span class="s2">&quot; corrupted -&quot;</span><span class="p">,</span> <span class="n">_info</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="s2">&quot;files corrupted&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;---------------&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="https://github.com/lucasrodes/pyphoon/tree/master/scripts/corrupted_images.py">script</a></p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Examples</a><ul>
<li><a class="reference internal" href="#integrating-the-data">1. Integrating the data</a><ul>
<li><a class="reference internal" href="#generate-a-typhoonsequence-hdf-file">1.1 Generate a TyphoonSequence HDF File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dataset-overview">2. Dataset overview</a><ul>
<li><a class="reference internal" href="#mean-image">2.1 Mean image</a></li>
<li><a class="reference internal" href="#visualize-a-typhoonlist">2.2 Visualize a TyphoonList</a></li>
</ul>
</li>
<li><a class="reference internal" href="#corrupted-files">3. Corrupted files</a><ul>
<li><a class="reference internal" href="#corrupted-images">3.1 Corrupted images</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyphoon 2018a documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Lucas Rodes-Guirao.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>