
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyphoon.clean &#8212; pyphoon 2018a documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2018a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pyphoon.utils" href="pyphoon.utils.html" />
    <link rel="prev" title="pyphoon.io" href="pyphoon.io.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyphoon.utils.html" title="pyphoon.utils"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pyphoon.io.html" title="pyphoon.io"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyphoon 2018a documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-pyphoon.clean.__init__">
<span id="pyphoon-clean"></span><h1>pyphoon.clean<a class="headerlink" href="#module-pyphoon.clean.__init__" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyphoon.clean.__init__.fix_sequence">
<code class="descclassname">pyphoon.clean.__init__.</code><code class="descname">fix_sequence</code><span class="sig-paren">(</span><em>typhoon_sequence</em>, <em>correct_frames=True</em>, <em>gap_filling=False</em>, <em>display=False</em>, <em>n_frames_th=6</em>, <em>fix_params=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyphoon.clean.__init__.fix_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Goes through a typhoon sequence and corrects its frames. This includes
detecting and correcting corrupted images as well as filling some
image temporal gaps by using interpolation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>typhoon_sequence</strong> (<a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList"><em>TyphoonList</em></a>) – Sequence of typhoon data. All frames should
belong to a certain typhoon sequence.</li>
<li><strong>correct_frames</strong> (<em>bool</em><em>, </em><em>default True</em>) – Set to False if frames should not be corrected.</li>
<li><strong>gap_filling</strong> (<em>bool</em><em>, </em><em>default False</em>) – Set to True if temporal image
frame gaps should be filled with synthetic image frames.</li>
<li><strong>display</strong> – Set to True if alerts and running information should be
displayed</li>
<li><strong>n_frames_th</strong> – </li>
<li><strong>fix_params</strong> – parameters required for the detection/correction of
corrupted image frame regions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fixed typhoon sequence</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList">TyphoonList</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><p class="first">For this example, we use the typhoon sequence <em>198702</em>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyphoon.io</span> <span class="k">import</span> <span class="n">read_typhoonlist_h5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">typhoon_sequence</span> <span class="o">=</span> <span class="n">read_typhoonlist_h5</span><span class="p">(</span><span class="s1">&#39;path/to//198702.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we can fix the sequence in multiple ways. By default, temporal
gaps are not filled and. To have information messages about the fixing
process we set the option <em>display</em> to be True.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyphoon.clean</span> <span class="k">import</span> <span class="n">fix_sequence</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">typhoon_sequence_new</span> <span class="o">=</span> <span class="n">fix_sequence</span><span class="p">(</span><span class="n">typhoon_sequence</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If we want to change the detection/correction parameters, say to
lower the minimum threshold we can do as following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">typhoon_sequence_new</span> <span class="o">=</span> <span class="n">fix_sequence</span><span class="p">(</span><span class="n">typhoon_sequence</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;min_th&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">})</span>
</pre></div>
</div>
<p>In case that we want to fill the temporal gaps, use as follows</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">typhoon_sequence_new</span> <span class="o">=</span> <span class="n">fix_sequence</span><span class="p">(</span><span class="n">typhoon_sequence</span><span class="p">,</span> <span class="n">gap_filling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;min_th&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">})</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyphoon.clean.__init__.fix_frame">
<code class="descclassname">pyphoon.clean.__init__.</code><code class="descname">fix_frame</code><span class="sig-paren">(</span><em>typhoon_sequence</em>, <em>index</em>, <em>display</em>, <em>params</em>, <em>detect_fct</em>, <em>correct_fct</em><span class="sig-paren">)</span><a class="headerlink" href="#pyphoon.clean.__init__.fix_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches for frame regions with corrupted pixels and attempts to
correct those.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>typhoon_sequence</strong> (<a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList"><em>TyphoonList</em></a>) – Sequence of typhoon data.</li>
<li><strong>index</strong> (<em>int</em>) – Frame position within <em>typhoon_sequence</em>.</li>
<li><strong>display</strong> (<em>bool</em>) – Set to True to have information messages printed.</li>
<li><strong>params</strong> (<em>dict</em>) – Parameters required for detection and correction functions.</li>
<li><strong>detect_fct</strong> (<em>callable</em>) – Corrupted pixel area detection function.</li>
<li><strong>correct_fct</strong> (<em>callable</em>) – Corrupted pixel area correction function.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyphoon.clean.__init__.fill_gaps">
<code class="descclassname">pyphoon.clean.__init__.</code><code class="descname">fill_gaps</code><span class="sig-paren">(</span><em>typhoon_sequence</em>, <em>n_frames_th</em><span class="sig-paren">)</span><a class="headerlink" href="#pyphoon.clean.__init__.fill_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the temporal image frame gaps of <em>typhoon_sequence</em> with
interpolated image frames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>typhoon_sequence</strong> (<a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList"><em>TyphoonList</em></a>) – Sequence of typhoon data.</li>
<li><strong>n_frames_th</strong> (<em>int</em>) – Threshold above which it should not be interpolated
anymore. This is done so as to prevent from filling too long gaps,
which could lead to very blurry and distorted frames.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyphoon.clean.__init__.interpolate_image_frames">
<code class="descclassname">pyphoon.clean.__init__.</code><code class="descname">interpolate_image_frames</code><span class="sig-paren">(</span><em>typhoon_sequence</em>, <em>frame_idx_0</em>, <em>frame_idx_1</em>, <em>n_frames=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pyphoon.clean.__init__.interpolate_image_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Linearly interpolates two frames from a typhoon sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>typhoon_sequence</strong> (<a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList"><em>TyphoonList</em></a>) – Sequence of typhoon data</li>
<li><strong>frame_idx_0</strong> (<em>int</em>) – First frame index</li>
<li><strong>frame_idx_1</strong> (<em>int</em>) – Second frame index</li>
<li><strong>n_frames</strong> (<em>int</em>) – Number of frames to generate using interpolation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List with the new generated frames</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyphoon.clean.__init__.generate_image_frames_ids">
<code class="descclassname">pyphoon.clean.__init__.</code><code class="descname">generate_image_frames_ids</code><span class="sig-paren">(</span><em>typhoon_sequence</em>, <em>frame_idx_0</em>, <em>frame_idx_1</em>, <em>n_frames=1</em><span class="sig-paren">)</span><a class="headerlink" href="#pyphoon.clean.__init__.generate_image_frames_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates ids of n_frames in between positions frame_idx_0 and
fram_idx_1. This is useful when new image frames have been generated
through interpolation and require an id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>typhoon_sequence</strong> (<a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList"><em>TyphoonList</em></a>) – Sequence of typhoon</li>
<li><strong>frame_idx_0</strong> (<em>int</em>) – Index of first frame</li>
<li><strong>frame_idx_1</strong> (<em>int</em>) – Index of second frame</li>
<li><strong>n_frames</strong> – Number of frames for which an id has to be generated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of newly generated ids.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyphoon.clean.__init__.find_corrupted_frames">
<code class="descclassname">pyphoon.clean.__init__.</code><code class="descname">find_corrupted_frames</code><span class="sig-paren">(</span><em>typhoon_sequence</em>, <em>mean_th=None</em>, <em>max_th=None</em>, <em>min_th=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyphoon.clean.__init__.find_corrupted_frames" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds corrupted frames within the sequence under certain
criteria. There are three different categories under which a frame
can fall as corrupted.</p>
<ol class="arabic simple">
<li>Mean-corrupted: A frame is considered <em>mean-corrupted</em> if its
pixel intensity mean is not in the range given by the function
argument <em>mean_th</em>.</li>
<li>Max-corrupted: A frame is considered <em>max-corrupted</em> if its
maximum pixel intensity value is not within the range given by the
function argument <em>max_th</em>.</li>
<li>Min-corrupted: A frame is considered <em>min-corrupted</em> if its
minimum pixel intensity value is not within the range given by the
function argument <em>min_th</em>.</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>typhoon_sequence</strong> (<a class="reference internal" href="pyphoon.utils.html#pyphoon.io.__init__.TyphoonList" title="pyphoon.io.__init__.TyphoonList"><em>TyphoonList</em></a>) – Sequence of a certain typhoon</li>
<li><strong>mean_th</strong> (<em>list</em>) – Minimum and maximum value accepted for an image pixel
intensity mean. By default range [235, 292] is used.</li>
<li><strong>max_th</strong> (<em>list</em>) – Minimum and maximum value accepted for an image
maximum pixel intensity value. By default range [277,
324] is used.</li>
<li><strong>min_th</strong> (<em>list</em>) – Minimum and maximum value accepted for an image
minimum pixel intensity value. By default range [165,
235] is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List with corrupted frame indices. Also a list with the details
about the corrupted files.</p>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyphoon.io</span> <span class="k">import</span> <span class="n">read_typhoonlist_h5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load sequence from HDF file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;data/201626.h5&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">typhoon_sequence</span> <span class="o">=</span> <span class="n">read_typhoonlist_h5</span><span class="p">(</span><span class="n">path_to_file</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">corrupted_frames</span><span class="p">,</span> <span class="n">corrupted_info</span> <span class="o">=</span> <span class="n">typhoon_sequence</span><span class="o">.</span><span class="n">find_corrupted_frames</span><span class="p">()</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pyphoon.utils.html" title="pyphoon.utils"
             >next</a> |</li>
        <li class="right" >
          <a href="pyphoon.io.html" title="pyphoon.io"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyphoon 2018a documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Lucas Rodes-Guirao.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>